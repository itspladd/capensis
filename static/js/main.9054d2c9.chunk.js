(this.webpackJsonptimekeeper=this.webpackJsonptimekeeper||[]).push([[0],{35:function(e,t,n){},36:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){"use strict";n.r(t);n(30);var c=n(1),a=n.n(c),s=n(27),r=n.n(s),i=(n(35),n(2)),o=(n(36),n(3)),l=n.n(o),j=n(11),u=n(4),b=n(0);function d(e){var t=e.username,n=e.handleLogout;e.currentSession;return Object(b.jsx)("div",{className:"navbar navbar-expand-sm navbar-light bg-info",children:Object(b.jsxs)("div",{className:"container-fluid",children:[Object(b.jsx)(j.b,{className:"navbar-brand",to:"/",children:"Timekeeper"}),Object(b.jsx)("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(b.jsx)("span",{className:"navbar-toggler-icon"})}),Object(b.jsx)("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",children:Object(b.jsxs)("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)(j.c,{className:"nav-link",to:"/day",children:"Day"})}),Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)(j.c,{className:"nav-link",to:"/week",children:"Week"})}),Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)(j.c,{to:"/projects",className:"nav-link",children:"Projects"})}),Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)(j.c,{className:"nav-link",to:"/reports",children:"Reports"})})]})}),Object(b.jsxs)("div",{className:"d-flex",children:[Object(b.jsxs)("span",{className:"navbar-text me-2",children:["Logged in as ",t]}),Object(b.jsx)("button",{className:"btn btn-outline-dark",onClick:n,children:"Logout"})]})]})})}n(65);function m(e){var t=e.currentSession,n=e.projects,c=void 0!==t.id,a=c&&n[t.project_id].title;return Object(b.jsxs)("div",{className:"statusBar border-top border-info\n      ".concat(c?"bg-warning":"bg-info"),children:[t.id&&"Currently tracking ".concat(a),!t.id&&"Not currently tracking"]})}var O=n(9);function h(e){var t=e.setUsername,n=function(){var e=Object(c.useState)({loginUsername:"",loginPass:"",registerUsername:"",registerPass:""}),t=Object(i.a)(e,2),n=t[0],a=t[1];return[n,function(e){e.preventDefault(),a((function(t){var n=Object(O.a)({},t);return n[e.target.name]=e.target.value,n}))}]}(),a=Object(i.a)(n,2),s=a[0],r=a[1];return Object(b.jsxs)("div",{className:"login-register",children:[Object(b.jsx)("div",{className:"login",children:Object(b.jsxs)("form",{onSubmit:function(e){e.preventDefault();var n=s.loginUsername,c=s.loginPass;console.log("Logging in with username: ".concat(n," and password: ").concat(c)),l.a.post("/api/login",{username:n,rawPassword:c}).then((function(e){return t(e.data.username)}))},children:[Object(b.jsx)("label",{htmlFor:"loginUsername",children:"Username: "}),Object(b.jsx)("input",{name:"loginUsername",type:"text",value:s.loginUsername,onChange:r}),Object(b.jsx)("label",{htmlFor:"loginPass",children:"Password: "}),Object(b.jsx)("input",{name:"loginPass",type:"password",value:s.loginPass,onChange:r}),Object(b.jsx)("button",{children:"Login"})]})}),Object(b.jsx)("div",{className:"register",children:Object(b.jsxs)("form",{onSubmit:function(e){e.preventDefault();var n=s.registerUsername,c=s.registerPass;console.log("Registering a new user with username: ".concat(n," and password: ").concat(c)),l.a.post("/api/users",{username:n,rawPassword:c}).then((function(e){return t(e.data.username)}))},children:[Object(b.jsx)("label",{htmlFor:"registerUsername",children:"Username: "}),Object(b.jsx)("input",{name:"registerUsername",type:"text",value:s.registerUsername,onChange:r}),Object(b.jsx)("label",{htmlFor:"registerPass",children:"Password: "}),Object(b.jsx)("input",{name:"registerPass",type:"password",value:s.registerPass,onChange:r}),Object(b.jsx)("button",{children:"Register"})]})})]})}n(66);function p(e){var t=e.blocks,n=e.day,c=t.filter((function(e){return e.props.day.getDate()===n.getDate()}));return Object(b.jsx)("div",{className:"blockList",children:c})}function f(e){var t=e.blocks,n=e.day,c=e.tomorrow,a=e.yesterday;return Object(b.jsxs)("div",{className:"daySchedule",children:[Object(b.jsx)("h3",{children:n.toDateString()}),Object(b.jsxs)("div",{className:"dayScheduleInternal",children:[Object(b.jsx)("button",{className:"btn btn-primary",onClick:a,children:"<--"}),Object(b.jsx)(p,{blocks:t,day:n}),Object(b.jsx)("button",{className:"btn btn-primary",onClick:c,children:"--\x3e"})]})]})}function x(e){return Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"WeekSchedule component"})})}var v=n(14);function g(e){var t=e.id,n=e.title,c=e.selected,a=e.onEditClick,s=e.onCancelClick,r=e.onSubmit,i=e.formValue,o=e.handleChange;return Object(b.jsxs)("li",{className:"list-group-item d-flex justify-content-between",children:[Object(b.jsx)("span",{children:Object(b.jsx)("strong",{children:n})}),c&&Object(b.jsxs)("form",{className:"row row-cols-sm-auto g-3 align-items-center",onSubmit:r,children:[Object(b.jsxs)("div",{className:"col-12",children:[Object(b.jsx)("label",{className:"visually-hidden",htmlFor:"newName",children:"New name: "}),Object(b.jsx)("input",{type:"text",className:"form-control form-control-sm",id:"newName",value:i,onChange:o})]}),Object(b.jsx)("div",{className:"col-12",children:Object(b.jsx)("button",{className:"btn btn-sm btn-secondary",children:"Submit"})}),Object(b.jsx)("div",{className:"col-12",children:Object(b.jsx)("button",{className:"btn btn-sm btn-danger",onClick:s,children:"Cancel"})})]}),!c&&Object(b.jsx)("button",{className:"btn btn-sm btn-info",onClick:a,children:"Rename"})]},t)}function N(e){var t=e.projects,n=e.setProjects,a=Object(c.useState)(null),s=Object(i.a)(a,2),r=s[0],o=s[1],j=Object(c.useState)(null),u=Object(i.a)(j,2),d=u[0],m=u[1],h=Object(c.useState)(!1),p=Object(i.a)(h,2),f=p[0],x=p[1],N=Object(c.useState)(""),k=Object(i.a)(N,2),w=k[0],y=k[1],S=function(e){e.preventDefault(),o(null)},C=function(e){m(e.target.value)},P=Object.values(t).map((function(e){return Object(b.jsx)(g,Object(O.a)(Object(O.a)({},e),{},{selected:e.id===r,onEditClick:function(){return o(e.id)},onCancelClick:S,onSubmit:function(c){return function(e,c){e.preventDefault();var a=null!==d?d:t[c].title;o(null),m(null);var s=Object(O.a)(Object(O.a)({},t[c]),{},{title:a});n((function(e){return Object(O.a)(Object(O.a)({},e),{},Object(v.a)({},c,s))})),l.a.patch("/api/projects/".concat(c),{title:a}).then((function(e){return console.log(e)}))}(c,e.id)},handleChange:C,formValue:null===d?e.title:d}))}));return Object(b.jsxs)("div",{className:"container",children:[Object(b.jsx)("h3",{children:"My Projects"}),Object(b.jsx)("ul",{className:"list-group",children:P}),Object(b.jsxs)("div",{className:"newProject",children:[!f&&Object(b.jsx)("button",{className:"btn btn-primary",onClick:function(){return x(!0)},children:"Add a Project"}),f&&Object(b.jsxs)("form",{className:"row row-cols-lg-auto g-3",onSubmit:function(e){e.preventDefault(),l.a.post("/api/projects",{projectTitle:w}).then((function(e){var t=e.data;n((function(e){return Object(O.a)(Object(O.a)({},e),{},Object(v.a)({},t.id,t))}))})).then((function(){y(""),x(!1)}))},children:[Object(b.jsxs)("div",{className:"col-12",children:[Object(b.jsx)("label",{className:"visually-hidden",htmlFor:"newProject",children:"New project name:"}),Object(b.jsx)("input",{className:"form-control",type:"text",id:"newProject",value:w,onChange:function(e){y(e.target.value)}})]}),Object(b.jsx)("div",{className:"col-12",children:Object(b.jsx)("button",{className:"btn btn-success",type:"submit",children:"Submit"})}),Object(b.jsx)("div",{className:"col-12",children:Object(b.jsx)("button",{className:"btn btn-danger",type:"button",onClick:function(e){e.preventDefault(),y(""),x(!1)},children:"Cancel"})})]})]})]})}function k(e){var t=e.projects,n=Object(c.useState)([]),a=Object(i.a)(n,2),s=a[0],r=a[1];Object(c.useEffect)((function(){l.a.get("/api/reports/week").then((function(e){return r(e.data)}))}),[t]);var o=s.map((function(e){var n=e.project_id,c=e.sessions_total,a=e.blocks_total,s=t[n].title,r=1/3600,i=c*r||0,o=a*r||0;return Object(b.jsxs)("li",{children:[s,": ",i.toPrecision(1)," / ",o," hours"]},n)}));return Object(b.jsx)("div",{className:"reports",children:Object(b.jsx)("ul",{children:o})})}n(67);function w(e){var t=e.title,n=e.project_id,c=e.schedule_date,a=e.start_time,s=e.end_time;return Object(b.jsxs)("div",{className:"block",projectid:n,children:[Object(b.jsx)("h5",{children:t}),Object(b.jsxs)("ul",{children:[Object(b.jsxs)("li",{children:["Day: ",c]}),Object(b.jsxs)("li",{children:["Starts at: ",a]}),Object(b.jsxs)("li",{children:["Ends at: ",s]})]})]})}function y(e){var t=864e5*e.getDay(),n=e.valueOf()-t;return new Date(n)}function S(e){var t,n=new Date;(t=n).setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0);var a=y(n),s=Object(c.useState)(n),r=Object(i.a)(s,2),o=r[0],j=r[1],u=Object(c.useState)(a),d=Object(i.a)(u,2),m=d[0],h=d[1],p=Object(c.useState)([]),f=Object(i.a)(p,2),x=f[0],v=f[1],g=function(){l.a.get("/api/blocks/week?date=".concat(o.toISOString())).then((function(e){return e.data.map((function(e){return Object(b.jsx)(w,Object(O.a)({day:new Date(e.start_time)},e))}))})).then((function(e){return v(e)}))};Object(c.useEffect)(g,[e]),Object(c.useEffect)((function(){var e=y(o);m.getDate()!==e.getDate()&&(h(e),g())}),[o]);return[x,o,function(e){var t=864e5*e;j(new Date(o.valueOf()+t))}]}function C(){var e=function(){var e=Object(c.useState)(!0),t=Object(i.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(null),r=Object(i.a)(s,2),o=r[0],j=r[1];return Object(c.useEffect)((function(){l.a.post("/api/authenticate").then((function(e){j(e.data.username),a(!1)}))}),[]),[n,o,j,function(e){e.preventDefault(),l.a.post("/api/logout").then((function(e){return j(e.data.username)}))}]}(),t=Object(i.a)(e,4),n=t[0],a=t[1],s=t[2],r=t[3],o=S(a),O=Object(i.a)(o,3),p=O[0],v=O[1],g=O[2],w=function(e){var t=Object(c.useState)({}),n=Object(i.a)(t,2),a=n[0],s=n[1];return Object(c.useEffect)((function(){}),[e]),[a,function(e){var t=e.target.closest(".block");if(t){var n=Number(t.getAttribute("projectid"));a.id&&l.a.patch("/api/sessions",{session_id:a.id}).then((function(e){return console.log("stopped session:",e.data)})),console.log("checking ".concat(n," vs ").concat(a.project_id,", result: ").concat(n===a.project_id)),n===a.project_id?s({}):l.a.post("/api/sessions",{project_id:n}).then((function(e){return s(e.data)}))}}]}(a),y=Object(i.a)(w,2),C=y[0],P=y[1],D=Object(c.useState)({}),U=Object(i.a)(D,2),_=U[0],E=U[1];return Object(c.useEffect)((function(){l.a.get("/api/projects").then((function(e){var t={};e.data.projects.forEach((function(e){return t[e.id]=e})),E(t)}))}),[a]),Object(b.jsxs)("div",{className:"App",onClick:P,children:[n&&Object(b.jsx)("p",{children:"Currently loading..."}),!n&&!a&&Object(b.jsx)(h,{setUsername:s}),!n&&a&&Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)(j.a,{basename:"/timekeeper",children:[Object(b.jsx)(d,{username:a,handleLogout:r,currentSession:C}),Object(b.jsx)(m,{currentSession:C,projects:_}),Object(b.jsxs)(u.c,{children:[Object(b.jsx)(u.a,{exact:!0,path:["/","/day"],children:Object(b.jsx)(f,{blocks:p,day:v,tomorrow:function(){return g(1)},yesterday:function(){return g(-1)}})}),Object(b.jsx)(u.a,{exact:!0,path:"/week",children:Object(b.jsx)(x,{})}),Object(b.jsx)(u.a,{exact:!0,path:"/projects",children:Object(b.jsx)(N,{projects:_,setProjects:E})}),Object(b.jsx)(u.a,{exact:!0,path:"/reports",children:Object(b.jsx)(k,{projects:_})})]})]})})]})}console.log("found a variable:","https://capensis-api.herokuapp.com"),l.a.defaults.baseURL="https://capensis-api.herokuapp.com",l.a.defaults.withCredentials=!0,r.a.render(Object(b.jsx)(a.a.StrictMode,{children:Object(b.jsx)(C,{})}),document.getElementById("root"))}},[[68,1,2]]]);
//# sourceMappingURL=main.9054d2c9.chunk.js.map